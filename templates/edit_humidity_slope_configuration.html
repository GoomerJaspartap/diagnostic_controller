{% extends 'base.html' %}
{% block title %}Edit Humidity Slope Configuration - Diagnostic Controller{% endblock %}

{% block content %}
<style>
    .edit-container {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .current-values {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 24px;
        border: 1px solid #dee2e6;
    }
    
    .current-value-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #e9ecef;
    }
    
    .current-value-item:last-child {
        border-bottom: none;
    }
    
    .current-value-label {
        font-weight: 600;
        color: #495057;
    }
    
    .current-value-data {
        font-family: 'Courier New', monospace;
        background: white;
        padding: 4px 8px;
        border-radius: 4px;
        border: 1px solid #dee2e6;
        color: #003366;
    }
    
    .humidity-range-section,
    .season-section {
        background: white;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid #e9ecef;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .humidity-range-title,
    .season-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #003366;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .season-badge {
        font-size: 0.8em;
        padding: 4px 8px;
        border-radius: 12px;
        font-weight: 600;
        color: white;
    }
    
    .season-badge.summer {
        background-color: #ff6b35;
    }
    
    .season-badge.fall {
        background-color: #f39c12;
    }
    
    .season-badge.winter {
        background-color: #3498db;
    }
    
    .form-label {
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
    }
    
    .form-control {
        border-radius: 6px;
        border: 1px solid #dee2e6;
        padding: 10px 12px;
    }
    
    .form-control:focus {
        border-color: #003366;
        box-shadow: 0 0 0 0.2rem rgba(0, 51, 102, 0.25);
    }
    
    .help-text {
        font-size: 0.85rem;
        color: #6c757d;
        margin-top: 4px;
    }
    
    .btn-primary {
        background-color: #003366;
        border-color: #003366;
        padding: 10px 24px;
        font-weight: 500;
        border-radius: 6px;
    }
    
    .btn-primary:hover {
        background-color: #004080;
        border-color: #004080;
    }
    
    .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
        padding: 10px 24px;
        font-weight: 500;
        border-radius: 6px;
    }
    
    .slope-inputs {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
    }
    
    .slope-input-group {
        background: #f8f9fa;
        border-radius: 6px;
        padding: 15px;
        border: 1px solid #e9ecef;
    }
    
    .slope-input-group label {
        font-size: 0.9rem;
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
    }
    
    .slope-input-group .form-control {
        font-size: 0.9rem;
        padding: 8px 10px;
    }
</style>

<div class="edit-container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>
            <i class="fas fa-edit me-2"></i>Edit Humidity Slope Configuration
        </h2>
        <a href="{{ url_for('configurations') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Back to Configurations
        </a>
    </div>

    <!-- Current Values Display -->
    <div class="current-values">
        <h5 class="mb-3">
            <i class="fas fa-info-circle me-2"></i>Current Configuration Values
        </h5>
        <div class="current-value-item">
            <span class="current-value-label">Chamber:</span>
            <span class="current-value-data">
                {% if config.room_id %}
                    {% for room in rooms %}
                        {% if room[0] == config.room_id %}
                            {{ room[1] }}
                        {% endif %}
                    {% endfor %}
                {% else %}
                    General
                {% endif %}
            </span>
        </div>
        <div class="current-value-item">
            <span class="current-value-label">Humidity Range:</span>
            <span class="current-value-data">{{ "%.1f"|format(config.humidity_min) }}% - {{ "%.1f"|format(config.humidity_max) }}%</span>
        </div>
        <div class="current-value-item">
            <span class="current-value-label">Summer Positive Slope:</span>
            <span class="current-value-data">{{ "%.3f"|format(config.summer_positive_slope) }}</span>
        </div>
        <div class="current-value-item">
            <span class="current-value-label">Summer Negative Slope:</span>
            <span class="current-value-data">{{ "%.3f"|format(config.summer_negative_slope) }}</span>
        </div>
        <div class="current-value-item">
            <span class="current-value-label">Fall Positive Slope:</span>
            <span class="current-value-data">{{ "%.3f"|format(config.fall_positive_slope) }}</span>
        </div>
        <div class="current-value-item">
            <span class="current-value-label">Fall Negative Slope:</span>
            <span class="current-value-data">{{ "%.3f"|format(config.fall_negative_slope) }}</span>
        </div>
        <div class="current-value-item">
            <span class="current-value-label">Winter Positive Slope:</span>
            <span class="current-value-data">{{ "%.3f"|format(config.winter_positive_slope) }}</span>
        </div>
        <div class="current-value-item">
            <span class="current-value-label">Winter Negative Slope:</span>
            <span class="current-value-data">{{ "%.3f"|format(config.winter_negative_slope) }}</span>
        </div>
    </div>

    <!-- Form -->
    <div class="card shadow">
        <div class="card-body">
            <form method="POST">
                <!-- Room Selection Section -->
                <div class="humidity-range-section">
                    <div class="humidity-range-title">
                        <i class="fas fa-building"></i>
                        Chamber Selection
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="room_id" class="form-label">Select Chamber</label>
                            <select class="form-control" id="room_id" name="room_id" required>
                                <option value="">Choose a chamber...</option>
                                {% for room in rooms %}
                                <option value="{{ room[0] }}" {% if room[0] == config.room_id %}selected{% endif %}>{{ room[1] }}</option>
                                {% endfor %}
                            </select>
                            <div class="help-text">Select the chamber this humidity configuration applies to</div>
                        </div>
                    </div>
                </div>

                <!-- Humidity Range Section -->
                <div class="humidity-range-section">
                    <div class="humidity-range-title">
                        <i class="fas fa-tint"></i>
                        Humidity Range
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="humidity_min" class="form-label">Minimum Humidity (%)</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="humidity_min" 
                                   name="humidity_min" 
                                   step="0.1" 
                                   required 
                                   value="{{ "%.1f"|format(config.humidity_min) }}"
                                   placeholder="e.g., 40.0">
                            <div class="help-text">Enter the lower bound of the humidity range</div>
                        </div>
                        <div class="col-md-6">
                            <label for="humidity_max" class="form-label">Maximum Humidity (%)</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="humidity_max" 
                                   name="humidity_max" 
                                   step="0.001" 
                                   required 
                                   value="{{ "%.1f"|format(config.humidity_max) }}"
                                   placeholder="e.g., 60.0">
                            <div class="help-text">Enter the upper bound of the humidity range</div>
                        </div>
                    </div>
                </div>

                <!-- Summer Slope Section -->
                <div class="season-section">
                    <div class="season-title">
                        <span class="season-badge summer">Summer</span>
                        <span>Summer Season Slopes</span>
                    </div>
                    <div class="slope-inputs">
                        <div class="slope-input-group">
                            <label for="summer_positive_slope" class="form-label">Positive Slope</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="summer_positive_slope" 
                                   name="summer_positive_slope" 
                                   step="0.001" 
                                   required 
                                   value="{{ "%.3f"|format(config.summer_positive_slope) }}"
                                   placeholder="e.g., 0.125">
                            <div class="help-text">Slope for increasing humidity trends</div>
                        </div>
                        <div class="slope-input-group">
                            <label for="summer_negative_slope" class="form-label">Negative Slope</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="summer_negative_slope" 
                                   name="summer_negative_slope" 
                                   step="0.001" 
                                   required 
                                   value="{{ "%.3f"|format(config.summer_negative_slope) }}"
                                   placeholder="e.g., 0.125">
                            <div class="help-text">Slope for decreasing humidity trends</div>
                        </div>
                    </div>
                </div>

                <!-- Fall Slope Section -->
                <div class="season-section">
                    <div class="season-title">
                        <span class="season-badge fall">Fall</span>
                        <span>Fall Season Slopes</span>
                    </div>
                    <div class="slope-inputs">
                        <div class="slope-input-group">
                            <label for="fall_positive_slope" class="form-label">Positive Slope</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="fall_positive_slope" 
                                   name="fall_positive_slope" 
                                   step="0.001" 
                                   required 
                                   value="{{ "%.3f"|format(config.fall_positive_slope) }}"
                                   placeholder="e.g., 0.150">
                            <div class="help-text">Slope for increasing humidity trends</div>
                        </div>
                        <div class="slope-input-group">
                            <label for="fall_negative_slope" class="form-label">Negative Slope</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="fall_negative_slope" 
                                   name="fall_negative_slope" 
                                   step="0.001" 
                                   required 
                                   value="{{ "%.3f"|format(config.fall_negative_slope) }}"
                                   placeholder="e.g., 0.150">
                            <div class="help-text">Slope for decreasing humidity trends</div>
                        </div>
                    </div>
                </div>

                <!-- Winter Slope Section -->
                <div class="season-section">
                    <div class="season-title">
                        <span class="season-badge winter">Winter</span>
                        <span>Winter Season Slopes</span>
                    </div>
                    <div class="slope-inputs">
                        <div class="slope-input-group">
                            <label for="winter_positive_slope" class="form-label">Positive Slope</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="winter_positive_slope" 
                                   name="winter_positive_slope" 
                                   step="0.001" 
                                   required 
                                   value="{{ "%.3f"|format(config.winter_positive_slope) }}"
                                   placeholder="e.g., 0.175">
                            <div class="help-text">Slope for increasing humidity trends</div>
                        </div>
                        <div class="slope-input-group">
                            <label for="winter_negative_slope" class="form-label">Negative Slope</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="winter_negative_slope" 
                                   name="winter_negative_slope" 
                                   step="0.001" 
                                   required 
                                   value="{{ "%.3f"|format(config.winter_negative_slope) }}"
                                   placeholder="e.g., 0.175">
                            <div class="help-text">Slope for decreasing humidity trends</div>
                        </div>
                    </div>
                </div>

                <!-- Submit Buttons -->
                <div class="d-flex gap-3 justify-content-end mt-4">
                    <a href="{{ url_for('configurations') }}" class="btn btn-secondary">
                        <i class="fas fa-times me-2"></i>Cancel
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Update Configuration
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %} 